# Импорт SQL-дампа в PostgreSQL

Этот инструмент предназначен для импорта SQL-дампа, созданного с помощью экстрактора MySQL to PostgreSQL, в базу данных PostgreSQL.

## Требования

- Python 3.6 или выше
- PostgreSQL 10 или выше
- psql (клиент командной строки PostgreSQL)

## Использование

### Скрипт Python (рекомендуется)

```bash
python import_dump.py [путь_к_дампу] [опции]
```

#### Параметры:

- `путь_к_дампу` - путь к SQL-файлу дампа (по умолчанию: `dump.sql` в текущей директории)

#### Опции:

- `--host` - хост PostgreSQL (по умолчанию: localhost)
- `--port` - порт PostgreSQL (по умолчанию: 5432)
- `--user` - имя пользователя PostgreSQL (по умолчанию: postgres)
- `--password` - пароль PostgreSQL (по умолчанию: root)
- `--database` - имя базы данных PostgreSQL (по умолчанию: gar_simple_db)
- `--clean` - очистить существующие таблицы перед импортом
- `--psql-path` - путь к исполняемому файлу psql (по умолчанию: C:\Program Files\PostgreSQL\17\bin\psql.exe)

#### Примеры:

Импорт с параметрами по умолчанию:
```bash
python import_dump.py
```

Импорт указанного файла:
```bash
python import_dump.py D:/tmp/dump.sql
```

Импорт с указанными параметрами подключения:
```bash
python import_dump.py --host localhost --port 5432 --user postgres --password root --database gar_simple_db
```

Импорт с предварительной очисткой базы данных:
```bash
python import_dump.py --clean
```

### Пакетный файл Windows (альтернатива)

Для Windows также доступны пакетные файлы:

```bash
import_dump.bat [путь_к_дампу]
```

или

```bash
import_dump_with_cleanup.bat [путь_к_дампу]
```

## Особенности

- Проверка наличия и корректности файла дампа
- Проверка подключения к PostgreSQL
- Опциональная очистка существующих таблиц перед импортом
- Подробная диагностика процесса импорта
- Проверка успешности импорта и количества строк в импортированных таблицах
- Учет возможных проблем с регистром имен таблиц

## Устранение неполадок

### Проблемы с кодировкой

Если у вас возникают проблемы с кодировкой при импорте данных, попробуйте:

1. Убедиться, что ваш файл дампа сохранен в кодировке UTF-8
2. Проверить настройки кодировки в PostgreSQL (`SHOW client_encoding;` и `SHOW server_encoding;`)
3. При необходимости добавить в начало SQL-скрипта команду `SET client_encoding TO 'UTF8';`

### Таблицы не видны после импорта

Если таблицы не видны после импорта, но нет сообщений об ошибках:

1. Проверьте, не созданы ли таблицы с именами в другом регистре (например, LOCALITIES вместо localities)
2. Убедитесь, что таблицы созданы в схеме 'public'
3. Проверьте права доступа к таблицам

## Важные замечания

- Для больших файлов дампа процесс импорта может занять значительное время
- Перед импортом рекомендуется создать резервную копию базы данных
- Если у вас возникают ошибки о нехватке прав доступа, запустите скрипт от имени администратора 