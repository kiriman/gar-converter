# MySQL в PostgreSQL экстрактор для ГАР

Инструмент для экспорта данных из MySQL базы ГАР и подготовки их для импорта в PostgreSQL.

## Описание

Этот проект предназначен для конвертации данных Государственного адресного реестра (ГАР) из базы данных MySQL в формат, пригодный для импорта в PostgreSQL. Экстрактор учитывает различия в синтаксисе между MySQL и PostgreSQL, включая:

- Преобразование типов данных
- Правильное экранирование строковых значений
- Обработку булевых значений
- Корректный формат комментариев к таблицам и столбцам
- Оптимизацию запросов для вставки данных большими пакетами

## Требования

- Python 3.8+
- MySQL сервер с базой ГАР
- PostgreSQL сервер (для импорта результата)
- Зависимости из файла requirements.txt

## Установка

1. Клонируйте репозиторий:
```
git clone https://github.com/yourusername/gar-converter.git
cd gar-converter
```

2. Создайте и активируйте виртуальное окружение:
```
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
```

3. Установите зависимости:
```
pip install -r requirements.txt
```

4. Настройте параметры подключения в файле .env:
```
cp .env.example .env
# Отредактируйте .env, указав параметры ваших баз данных
```

## Использование

Для запуска экспорта выполните:

```
python mysql_to_postgres_exporter.py
```

Результат будет сохранен в файл, указанный в переменной окружения `DUMP_FILE_PATH` (по умолчанию - `dump.sql`).

### Импорт в PostgreSQL

Для импорта сгенерированного дампа в PostgreSQL выполните:

```
psql -h localhost -U username -d gar_simple_db -f dump.sql
```

Заменив `username` на имя пользователя PostgreSQL.

## Структура проекта

- **mysql_to_postgres_exporter.py** - основной скрипт для экспорта данных
- **db_utils.py** - утилиты для работы с базами данных
- **requirements.txt** - зависимости проекта
- **.env.example** - пример файла конфигурации
- **mysql_schema.sql** - схема исходной базы данных MySQL
- **psql_schema.sql** - схема целевой базы данных PostgreSQL

## Особенности реализации

Экстрактор выполняет следующие операции:

1. Подключается к исходной базе данных MySQL
2. Получает список таблиц и их структуру
3. Преобразует типы данных MySQL в соответствующие типы PostgreSQL
4. Генерирует SQL-скрипты для создания таблиц в PostgreSQL
5. Экспортирует данные из MySQL с правильным экранированием
6. Сохраняет результат в виде SQL-файла для импорта в PostgreSQL

Экспорт осуществляется с отслеживанием прогресса и оптимизирован для обработки больших объемов данных.

## Лицензия

MIT 